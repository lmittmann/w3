# ABI

ABI bindings allow the encoding and decoding of Smart Contract function calls or the decoding of events.
In `w3` ABI bindings are defined for individual functions or events at runtime using Solidity syntax.

* **Easy to write:** Creating an ABI binding only requires the Solidity function signature. No need
  to firstly generate an ABI json file using `solc` and secondly generate ABI bindings using `abigen`.
* **Flexible:** ABI bindings for a function or event can be used with any Smart Contract. No need to
  generate overlapping bindings for multiple Smart Contracts.


## Functions

Function ABI bindings can be defined using
* `func NewFunc(signature, returns string) (*Func, error)`, or
* `func MustNewFunc(signature, returns string) *Func` which panics on error.

### Examples

#### ERC20 `transfer`

The ERC20 `transfer` function can be defined as follows:
```go
funcTransfer := w3.MustNewFunc("transfer(address,uint256)", "bool")
```

Alternatively the function arguments and returns can also be named. Note, that Solidity type aliases
are also supported (e.g. `uint` for `uint256`):
```go
funcTransfer := w3.MustNewFunc("transfer(address to, uint amount)", "bool success")
```

#### Tuples

The UniSwap V3 [`IQuoterV2.sol`](https://github.com/Uniswap/v3-periphery/blob/main/contracts/interfaces/IQuoterV2.sol#L27-L53)
uses a tuple as argument for e.g. `quoteExactInputSingle`, which can be defined as follows:

```go
funcQuoteExactInputSingle := w3.MustNewFunc(
    `quoteExactInputSingle((
        address tokenIn,
        address tokenOut,
        uint256 amountIn,
        uint24 fee,
        uint160 sqrtPriceLimitX96
    ) params)`,
    `uint256 amountOut,
     uint160 sqrtPriceX96After,
     uint32 initializedTicksCrossed,
     uint256 gasEstimate`,
)
```

Note, that the Solidity struct arguments are wrapped in parenthesis and names are mandatory.

### `EncodeArgs`

### `DecodeArgs` and `DecodeReturns`




## Events

Event ABI bindings can be defined using
* `func NewEvent(signature string) (*Event, error)`, or
* `func MustNewEvent(signature string) *Event` which panics on error.

### Examples

#### ERC20 `Transfer`

```go
evtTransfer := w3.MustNewEvent("Transfer(address indexed from, address indexed to, uint256 value)")
```

---


# ABI Bindings

ABI bindings in `w3` are specified for individual functions using Solidity syntax and are usable for any contract that supports that function.

**Example:** ABI binding for the ERC20 `balanceOf` function ([Playground](https://pkg.go.dev/github.com/lmittmann/w3#example-NewFunc-BalanceOf))

```go
funcBalanceOf := w3.MustNewFunc("balanceOf(address)", "uint256")
```

**Example:** ABI binding for the Uniswap v4 `swap` function ([Playground](https://pkg.go.dev/github.com/lmittmann/w3#example-NewFunc-UniswapV4Swap))

```go
funcSwap := w3.MustNewFunc(`swap(
    (address currency0, address currency1, uint24 fee, int24 tickSpacing, address hooks) key,
    (bool zeroForOne, int256 amountSpecified, uint160 sqrtPriceLimitX96) params,
    bytes hookData
)`, "int256 delta")
```

A [`Func`](https://pkg.go.dev/github.com/lmittmann/w3#Func) can be used to

* encode arguments to the contracts input data ([`Func.EncodeArgs`](https://pkg.go.dev/github.com/lmittmann/w3#Func.EncodeArgs)),
* decode arguments from the contracts input data ([`Func.DecodeArgs`](https://pkg.go.dev/github.com/lmittmann/w3#Func.DecodeArgs)), and
* decode returns form the contracts output data ([`Func.DecodeReturns`](https://pkg.go.dev/github.com/lmittmann/w3#Func.DecodeReturns)).
